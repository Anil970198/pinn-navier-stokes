# Physics-Informed Neural Networks (PINNs) for Inverse Navier-Stokes Problems

## 1. Motivation: The Intersection of Deep Learning & Mathematical Physics
I have always been a fanatic when it comes to the raw elegance of Neural Networks and the rigorous beauty of Mathematical Coding. While standard Deep Learning excels at pattern recognition, I sought a challenge that requires **reasoning** within the constraints of physical laws. 

This journey led me to the **Navier-Stokes Equations**—the gold standard of fluid dynamics. The question was not just *“Can an AI predict fluid flow?”* but *“Can an AI **discover** the flow purely from the laws of physics, without needing simulation data?”* 

This project is the answer: A **Physics-Informed Neural Network (PINN)** that forces a Neural Network to obey the conservation of mass and momentum, effectively "learning physics" from scratch.

---

## 2. Mathematical Formulation
We address the problem of solving the incompressible **Navier-Stokes equation** in a 2D domain $\Omega \in \mathbb{R}^2$ over time $t$.

### 2.1 The Governing Equations
The fluid motion is governed by two fundamental laws:

1.  **Conservation of Momentum** (Navier-Stokes):
$$ \frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} = -\frac{1}{\rho} \nabla p + \nu \nabla^2 \mathbf{u} + \mathbf{f} $$

2.  **Conservation of Mass** (Continuity Equation for incompressible flow):
$$ \nabla \cdot \mathbf{u} = 0 $$

Where:
*   $\mathbf{u} = (u, v)$ is the velocity field.
*   $p$ is the pressure field.
*   $\nu$ is the kinematic viscosity ($\lambda_2$ in our code).
*   $\rho$ is fluid density (assumed 1).

### 2.2 The Physics-Informed Loss
Instead of training on "labels" $(y_{true})$, we train on the **Residuals of the PDE ($f$)**. We define our neural network approximation as $\mathbf{u}_\theta(x, y)$. The loss function $\mathcal{L}$ is minimized when satisfy the PDE:

$$ \mathcal{L}_{total} = \mathcal{L}_{physics} + \mathcal{L}_{boundary} $$

Where the physics loss $\mathcal{L}_{physics}$ is the mean squared error of the PDE residuals:
$$ \mathcal{L}_{physics} = \frac{1}{N_f} \sum_{i=1}^{N_f} \| f(x_i, y_i) \|^2 $$

In our code, we explicitly compute derivatives using **Automatic Differentiation** (`torch.autograd`), allowing us to compute exact gradients of the network with respect to input coordinates:

```python
# Exact calculation of PDE residuals via Autograd
u_x = grad(u, x)
u_xx = grad(u_x, x)
momentum_residual = (u * u_x + v * u_y) + p_x - viscosity * (u_xx + u_yy)
```

---

## 3. Methodology: SIREN Architecture
Standard ReLU networks struggle to model the higher-order derivatives (e.g., $\nabla^2 \mathbf{u}$) required for physics because their second derivative is zero almost everywhere.

To overcome this, I implemented a **SIREN (Sinusoidal Representation Network)**.
*   **Activation Function**: $\sin(\omega_0 \mathbf{Wx} + \mathbf{b})$
*   **Why?**: The derivative of a sine is a cosine (non-zero). This allows the network to model complex, high-frequency derivatives required for turbulence and fluid dynamics.

---

## 4. Results & Convergence
We trained the model for 5,000 iterations on a 2D domain.

### 4.1 Quantitative Convergence
The network achieved **perfect convergence**, solving the system to machine precision tolerances:
*   **Initial Loss**: `1.31563`
*   **Final Physics Loss**: `0.00000` (Iter 4900)

This implies that the vector field generated by the network satisfies the Navier-Stokes equations at every point in the domain.

### 4.2 Qualitative Visualization
Below is the Flow Field discovered by the AI. Note the formation of the smooth velocity gradient consistent with laminar channel flow.

![Flow Visualization](https://github.com/Anil970198/pinn-navier-stokes/blob/9a92b680a52d21363c84c03b5b61cc4c8190e2de/pinn_project/flow%20vectors.png)
*(Note: This visualization was generated dynamically during training via Weights & Biases)*

---

## 5. Future Work
*   **Inverse Parameter Discovery**: Currently, we assume viscosity $\nu$ is known. Future extensions will make $\nu$ a trainable parameter, allowing the AI to "measure" the viscosity of a fluid just by looking at a video of it.
*   **Turbulence Modeling (High Reynolds Number)**: Scaling the SIREN architecture to handle chaotic, turbulent flows ($Re > 2000$).
*   **3D Extension**: Extending the domain to $(x, y, z)$ to model volumetric flows.

---

## 6. How to Run
1.  **Install Dependencies**:
    ```bash
    pip install -r requirements.txt
    ```
2.  **Training**:
    ```bash
    python train.py
    ```
3.  **Visualization**:
    Results are logged automatically to the [Weights & Biases Dashboard](https://wandb.ai/).

    
